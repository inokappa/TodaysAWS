# 2018/08/30 今日の AWS

## 今日の AWS ~ AWS 認定 SysOps アドミニストレーター – アソシエイトレベルサンプル試験を解く (2) ~

公開されている[サンプル試験問題](https://d1.awsstatic.com/training-and-certification/docs-sysops-associate/AWS%20Certified%20SysOps%20-%20Associate_Exam%20Sample_v1_FINALJP.pdf)を解く. なぜ, その答えになるのかをちゃんと理解する必要がある. 

### Q7. Route53 による可用性の高い Web サイトの運用

#### 設問

世界中の 5 つのリージョンにおける 10 個の EC2 インスタンス（1 リージョンにつき 2 つのインスタンス）でウェブストアサイトをホスティングしています. 5 つのうち 1 つのリージョンで長時間ネットワーク接続が切断された場合、ダウンタイムを最小限に抑えてサイトの可用性を維持できるようにするには、サイトをどのように設定しますか?

```
A. Elastic Load Balancing を作成して、EC2 インスタンスの前に配置する各 ELB で適切なヘルスチェックを設定する
B. 各リージョンのインスタンス間で VPN 接続を確立し、リージョン全体で広範囲の接続切断が発生した場合は、BGP のフェイルオーバー機能を利用する
C. 各リージョンの Elastic Load Balancing について Route 53 レイテンシーベースのルーティングレコードセットを設定し、各 ELB で適切なヘルスチェックを設定する
D. Route 53 に Evaluate Target Health フラグを True としたレイテンシーベースのルーティングレコードセットを作成し、それを各リージョンの Elastic Load Balancing に紐づける
```

#### 解答

D. Route 53 に Evaluate Target Health フラグを True としたレイテンシーベースのルーティングレコードセットを作成し、それを各リージョンの Elastic Load Balancing に紐づける

#### メモ

* Evaluate Target Health
    * [AWS Black Belt Tech シリーズ 2016 - Amazon Route 53](https://www.slideshare.net/AmazonWebServicesJapan/aws-black-belt-tech-2016-amazon-route-53) 21 ページ目
    * Route 53が ALIAS ターゲットのヘルスチェックをするかどうかを指定する
* Route 53 の可用性を高める各種機能が熱い気がする

### Q8. ELB と Auto Scaling

#### 設問

Elastic Load Balancing（ELB）, EC2 上の 3 台のウェブ/アプリケーションサーバープロビジョンド IOPS が 5000 に設定された 1 台の MySQL RDS データベースで構成される, ステートレスウェブアプリケーションを実行しています.ユーザーへの平均応答時間が増加しています.CloudWatch を調べたところ, CPU 使用率はそれぞれ, ウェブ/アプリケーションサーバーで 95%, データベースでは 20% です. データベースディスクの平均操作回数は、2000 ～ 2500 です.

応答時間を向上させることのできる方法は次のうちどれですか? 2 つ選択してください.

```
A. ウェブ/アプリケーションサーバーに、より適切な CPU/メモリの割合を持つ別の EC2 インスタンスタイプを選択する。
B. Auto Scaling を使用し、CPU 負荷のしきい値に基づいて追加のウェブ/アプリケーションサーバーを追加する。
C. ウェブ/アプリケーション EC2 インスタンスで許可するオープン TCP 接続の数を増やす。
D. Auto Scaling を使用し、メモリ使用率のしきい値に基づいて追加のウェブ/アプリケーションサーバーを追加する。
```

#### 解答

A. ウェブ/アプリケーションサーバーに、より適切な CPU/メモリの割合を持つ別の EC2 インスタンスタイプを選択する。
B. Auto Scaling を使用し、CPU 負荷のしきい値に基づいて追加のウェブ/アプリケーションサーバーを追加する。

#### メモ

* ウェブ／アプリケーション・サーバーの CPU 使用率は高すぎだと思う

### Q9. S3 のアクセス制限

#### 設問

S3 内のデータへのアクセスを制限するには, どの機能を使えばよいですか? 2 つ選択してください.

```
A. バケットに CloudFront ディストリビューションを作成する。
B. S3 バケットポリシーを設定する。
C. S3 仮想ホスティングを使用する。
D. S3 ACL をバケットまたはオブジェクトに設定する。
E. IAM Identity Federation を有効にする。
```

#### 解答

B. S3 バケットポリシーを設定する。
D. S3 ACL をバケットまたはオブジェクトに設定する。

#### メモ

以下, S3 のアクセスコントロール方法各種.

* アクセスコントロールリスト (ACL)
    * バケットとオブジェクトそれぞれについて, 読み取り, 書き込み許可を他の AWS アカウントに与えることが出来る
    * 条件付きアクセス許可, アクセス拒否設定は出来ない
    * 自アカウント内の IAM ユーザー, グループのアクセス権を制限することも出来ない
* バケットポリシー
    * 自アカウント内の IAM ユーザーやグループ, 他のアカウントのユーザーに対してアクセス許可を与えることが出来る
    * 条件付きアクセス許可やアクセス拒否を設定することも出来る
* IAM ポリシー
    * S3 へのアクセス許可を設定した IAM ポリシーを自アカウント内の IAM ユーザーやグループ, ロールに割り当てることが出来る
    * 条件付きアクセス許可やアクセス拒否を設定することも出来る
    * 他アカウントを指定したアクセス権は設定出来ない

その他, アクセス期間を限定した**署名 (期限) 付き URL**も設定可能.

### Q10. バックアップ, アーカイブ戦略

#### 設問

AWS を使って, 会社のバックアップおよびアーカイブ戦略を確立する必要があります. コンプライアンス上の理由から, 書類は 3 か月間は即座のアクセスが可能な状態にし, 5 か月間は利用可能な状態にしておく必要があります. こうした要件を最もコスト効率の高い方法で達成する AWS サービスはどれですか?

```
A. StorageGateway を使用して S3 にデータを保存し、ライフサイクルポリシーを使用して Redshift にデータを移行し、長期間アーカイブする
B. DirectConnect を使用して S3 にデータをアップロードし、IAM ポリシーを使用して Glacier にデータを移行し、長期間アーカイブする
C. EBS でデータをアップロードし、ライフサイクルポリシーを使用して EBS スナップショットを S3 に移行し、後にGlacier に移行して長期間アーカイブする
D. S3 にデータをアップロードし、ライフサイクルポリシーを使用して Glacier にデータを移行し、長期間アーカイブする
```

#### 解答

D. S3 にデータをアップロードし、ライフサイクルポリシーを使用して Glacier にデータを移行し、長期間アーカイブする

#### メモ

* StorageGateway
    * [AWS Black Belt Online Seminar 2017 AWS Storage Gateway](https://www.slideshare.net/AmazonWebServicesJapan/aws-black-belt-online-seminar-2017-aws-storage-gateway)
    * ゲートウェイタイプ
        * ファイルゲートウェイ (NFS インターフェース, S3 オブジェクトをバックエンドとしたファイルストレージ)
        * ボリュームゲートウェイ (iSCSI ブロックインターフェース, S3, EBS スナップショットをバックエンドとしたブロックストレージ)
        * テープゲートウェイ (iSCSI 加藤テープライブラリインターフェース, S3, Glacier にデータを保管する仮想テープストレージと VTL 管理)
    * ボリュームゲートウェイ
        * Gateway-Stored Volumes
        * Gateway-Cached Volumes
* DirectConnect
    * [AWS Black Belt Techシリーズ AWS Direct Connect](https://www.slideshare.net/AmazonWebServicesJapan/aws-black-belt-tech-aws-direct-connect)
    * AWS とオンプレの間に専用線を設けてプライベート接続を提供するサービス
    * プライベート接続とパブリック接続

ﾌﾑﾌﾑ.
