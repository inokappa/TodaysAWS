# 2018/08/18 今日の AWS

## 今日の AWS ~ AWS 認定デベロッパー – アソシエイトレベルサンプル試験を解く (3) ~

公開されている[サンプル試験問題](https://d1.awsstatic.com/training-and-certification/docs-dev-associate/AWS%20Certified_Developer_associate_examsample_JP.pdf)を解く. なぜ, その答えになるのかをちゃんと理解する必要がある.

### Q8. STS について

#### 設問

企業ウェブアプリケーションを Amazon VPC 内にデプロイし、IPSec VPN 経由で企業データセンターに接続しています。このアプリケーションは、オンプレミスの LDAP サーバーに対して認証を行う必要があります。認証後、ログインしたユーザーは、そのユーザーに固有の S3 キー空間のみにアクセスできます。この目的を満たすことができる方法を、次の中から 1 つ選んでください。

```
A. アプリケーションを LDAP に対して認証する。次に、アプリケーションで IAM Security Token Service を呼び出して、LDAP 認証情報を使用して IAM にログインする。アプリケーションでは、IAM の一時的な認証情報を使用して適切な S3 バケットにアクセスできる。
B. アプリケーションを LDAP に対して認証し、ユーザーに関連する IAM ロールを取得する。次に、IAM Security Token Service を呼び出して、その IAM ロールを引き受ける。アプリケーションでは、一時的な認証情報を使用して適切な S3 バケットにアクセスできる。
C. LDAP 認証情報を使用して、アプリケーションを IAM Security Token Service に対して認証する。これらの一時的な AWS セキュリティ認証情報を使用して、適切な S3 バケットにアクセスする。
D. LDAP に対して認証を行う認証ブローカーを開発し、IAM Security Token Service を使用して IAM フェデレーションユーザー認証情報を取得する。アプリケーションで認証ブローカーを呼び出して、適切な S3 バケットへのアクセスを有する IAM フェデレーションユーザー認証情報を取得する。
E. IAM Security Token Service に対して認証を行って IAM ロールを引き受け、一時的な AWS セキュリティ認証情報を取得する認証ブローカーを開発する。アプリケーションで認証ブローカーを呼び出して、適切な S3 バケットへのアクセスを有する AWS の一時的なセキュリティ認証情報を取得する。
```

#### 正答

* D (LDAP に対して認証を行う認証ブローカーを開発し、IAM Security Token Service を使用して IAM フェデレーションユーザー認証情報を取得する。アプリケーションで認証ブローカーを呼び出して、適切な S3 バケットへのアクセスを有する IAM フェデレーションユーザー認証情報を取得する。)

#### メモ

* 設問や選択肢自体の日本語が分かり辛い
* 設問としては, **LDAP で認証させたユーザーに対して, 一時的に AWS リソースへのアクセスを許可するにはどうしたら良いか** ということを問われているような気がする
* 解答としては, ユーザー (アプリ) は認証ブローカーにリクエストを投げて, ブローカーが LDAP で認証し, 認証されたら STS に一時的な認証情報の取得を要求し, その情報を以て S3 にアクセスさせる...ってことなのかな

このあたりの理解は深めたいなー.

### Q9. S3 の署名付き URL について

#### 設問

広告収益モデルの写真共有ウェブサイトを運営しており、サイト訪問者への写真配信に S3 を使用しています。いつからかその写真に他のサイトが直接リンクを張るようになり、広告収益の減少を招いていることに気づきました。この影響を緩和するにはどの対策が効果的ですか?

```
A. 静的コンテンツに CloudFront ディストリビューションを使用する。
B. パブリックの読み込み権限を削除し、有効期限付きの署名 URL を使用する。
C. 被害を及ぼしているウェブサイトの IP をセキュリティグループで遮断する。
D. 写真をウェブサーバーの EBS ボリュームに保存する。
```

#### 正答

* B (パブリックの読み込み権限を削除し、有効期限付きの署名 URL を使用する。)

#### メモ

* 署名付き (有効期限付き) URL を発行する
    * アクセス許可設定をしていない特定のオブジェクトを指定した期間に限定して HTTPS アクセスで公開する
    * AWS CLI で設定した場合のデフォルトは 3600 秒 ([presign — AWS CLI 1.15.81 Command Reference](https://docs.aws.amazon.com/cli/latest/reference/s3/presign.html))

### Q10. S3 の仕様

#### 設問

アプリケーションで 6 GB のファイルを Simple Storage Service にアップロードしようとしていますが、「指定されたアップロードは、アップロード可能な最大オブジェクトサイズを超えています。」というメッセージが表示されます。これを解決する方法はありますか?

```
A. ない。Simple Storage Service オブジェクトは 5 GB に制限されている。
B. このオブジェクトにマルチパートアップロード API を使用する。
C. このオブジェクトに大きなオブジェクトのアップロード API を使用する。
D. サポートに連絡してオブジェクトサイズ制限を増やす。
E. 異なるリージョンにアップロードする。
```

#### 正答

* B (このオブジェクトにマルチパートアップロード API を使用する。)

#### メモ

* 1 ファイル最大 5TB まで
* 1 回にアップロード (1 つの PUT) 出来るサイズは 5GB まで, 5GB を超える場合にはマルチパートアップロード API を利用する
* バケット内のオブジェクト数は無制限

ﾌﾑﾌﾑ.
